<div class="page-timer" [ngClass]="{
  'focus-mode': currentTimerMode === 'Focus' && !isPreviewMode,
  'rest-mode': currentTimerMode === 'Riposo' && !isPreviewMode,
  'focus-mode-preview': currentTimerMode === 'Focus' && isPreviewMode,
  'rest-mode-preview': currentTimerMode === 'Riposo' && isPreviewMode
}">
  <main>
    <div class="contenuto">
      <app-timer
        [intervalDuration]="currentIntervalDuration"
        [timerMode]="currentTimerMode"
        [isForcedEndSession]="isForcedEndSession"
        [isPreviewMode]="isPreviewMode"
        (sessionFinish)="onCicleFinish()"
        (countingStatusChanged)="isSessionActive = $event"
      ></app-timer>

      <div class="cicles" *ngIf="!isPreviewMode">
        <div>CICLI</div>

        <div class="cicle-list">
          <div
            id="cicle"
            *ngFor="let cicle of cicles"
            [ngClass]="{ success: cicle }"
          ></div>
        </div>

        <div>
          <button class="btn btn--secondary" 
          (click)="forcedEndSession()"
          [disabled]="!isSessionActive">
            <mat-icon>stop_circle</mat-icon>
          </button>
        </div>
      </div>
      <div *ngIf="isPreviewMode" class="preview-info">
        <h3 class="preview-title">POMODORO ATTUALE</h3>

        <div class="preview-item">
          <div>
            <mat-icon class="preview-icon">check_circle</mat-icon>
            <span>Cicli terminati:</span>
          </div>
          <div>
            <strong>{{ cicleFinished }}/{{ cicles.length }}</strong>
          </div>
        </div>

        <div class="preview-item">
          <div>
            <mat-icon class="preview-icon">timer</mat-icon>
            <span>Tempo di focus: </span>
          </div>
          <div>
            <strong>{{ settings.work }} min</strong>
          </div>
        </div>

        <div class="preview-item">
          <div>
            <mat-icon class="preview-icon">coffee</mat-icon>
            <span>Tempo di break: </span>
          </div>
          <div>
            <strong>{{ settings.break }} min</strong>
          </div>
        </div>
      </div>

      <button
        *ngIf="!isPreviewMode"
        class="btn btn--secondary"
        (click)="openSettings()"
        [disabled]="isSessionActive"
      >
        <mat-icon>settings</mat-icon>
      </button>
    </div>
  </main>
  <div class="center-wrapper" *ngIf="showAnimation">
    <div class="session-complete-animation">
      <p>Sessione completata! Ottimo lavoro!</p>
    </div>
  </div>   
</div>
